import Quiz from "../models/quiz.model.js";
import { generateQuizFromAI } from "../services/quiz.services.js";

let quizzes = [
  {
    quizId: "13541245",
    title: "Java Core Quiz",
    description:
      "This quiz is generated by ai for prepareing java core for interview.",
    // numberOfQuestions: 100,
    // maxMakrs: 100,
    // time: 60,
    // questions: [
    //   {
    //     questionId: 7412,
    //     question: "What is Java?",
    //     option1: "what is programming language",
    //     option2: "Java is technology",
    //     option3: "java is music player",
    //     option4: "none of above",
    //     correct: "Java is technology",
    //   },
    //   {
    //     questionId: 8942415,
    //     question: "What is Java?",
    //     option1: "what is programming language",
    //     option2: "Java is technology",
    //     option3: "java is music player",
    //     option4: "none of above",
    //     correct: "Java is technology",
    //   },
    // ],
  },
  {
    quizId: "8452415454",
    title: "Node backend quiz",
    description:
      "This quiz contains question for those who is preparing for node backend.",
  },
  {
    quizId: "789764164",
    title: "Python core quiz",
    description: "This quiz contains questinos related to basics of python.",
  },
];
export const listQuizzes = async (req, resp) => {
  //file delete
  //email bhejne

  const q = await Quiz.find();

  return resp.json(q);
};

export const createQuiz = async (req, resp) => {
  //quiz create:...

  const {
    title,
    description,
    maxMarks,
    minusMarking,
    questions,
    instructions,
    maxTime,
  } = req.body;
  // console.log(quizId);
  // console.log(title);
  // console.log(description);
  const quiz = {
    title,
    description,
    maxMarks,
    minusMarking,
    questions,
    instructions,
    maxTime,
  };

  // quizzes.push(quiz);

  const resposneData = await Quiz.create(quiz);
  console.log(resposneData);
  return resp.send("quiz created");
};

// get single quiz
export const getSingleQuiz = async (req, resp) => {
  const { quizId } = req.params;
  console.log(quizId);

  const quiz = await Quiz.findOne({ _id: quizId }).populate("questions");

  // 10 --> 10 times

  return resp.json(quiz);
};

//delete and update
export const deleteQuiz = (req, resp) => {
  const { quizId } = req.params;

  const newQuizzes = quizzes.filter((quiz) => quiz.quizId != quizId);
  quizzes = newQuizzes;
  return resp.send("quiz is deleted !!");
};

// create quiz from ai
export const createQuizFromAI = async (req, resp) => {
  const { title, numberOfQuestions, description } = req.body;
  const response = await generateQuizFromAI(
    title,
    description,
    numberOfQuestions
  );

  return resp.json(response);
};
